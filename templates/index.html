<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EADE Business School Chatbot</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --chat-gradient: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            --success-gradient: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            --danger-gradient: linear-gradient(135deg, #fd746c 0%, #ff9068 100%);
            --dark-bg: #1a1a2e;
            --card-bg: #ffffff;
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at top left, rgba(255, 255, 255, 0.1) 0%, transparent 70%),
                radial-gradient(ellipse at bottom right, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            pointer-events: none;
        }

        .chat-container {
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: var(--shadow-xl);
            width: 100%;
            max-width: 900px;
            height: 85vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .chat-header {
            background: var(--chat-gradient);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%);
            pointer-events: none;
        }

        .chat-header-content {
            position: relative;
            z-index: 1;
        }

        .chat-header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .chat-header h1 i {
            font-size: 32px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .chat-header p {
            font-size: 16px;
            opacity: 0.95;
            font-weight: 400;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.5;
        }

        .online-status {
            position: absolute;
            top: 20px;
            right: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            opacity: 0.9;
        }

        .online-dot {
            width: 10px;
            height: 10px;
            background: #4ade80;
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .chat-messages {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: linear-gradient(to bottom, #f8fafc 0%, #f1f5f9 100%);
            position: relative;
        }

        .chat-messages::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, rgba(248, 250, 252, 1), rgba(248, 250, 252, 0));
            pointer-events: none;
            z-index: 1;
        }

        .message {
            margin-bottom: 24px;
            display: flex;
            align-items: flex-end;
            animation: messageSlideIn 0.4s ease-out;
            position: relative;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.bot {
            justify-content: flex-start;
        }

        .message-content {
            max-width: 75%;
            padding: 18px 24px;
            border-radius: 24px;
            word-wrap: break-word;
            position: relative;
            font-size: 15px;
            line-height: 1.6;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }

        .message-content:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .message.user .message-content {
            background: var(--chat-gradient);
            color: white;
            border-bottom-right-radius: 8px;
            margin-right: 4px;
        }

        .message.bot .message-content {
            background: white;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-bottom-left-radius: 8px;
            margin-left: 4px;
        }

        .message-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            margin: 0 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            font-size: 15px;
            box-shadow: var(--shadow-md);
            position: relative;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--chat-gradient);
            order: 2;
        }

        .message.bot .message-avatar {
            background: var(--success-gradient);
            order: 1;
        }

        .message-avatar i {
            font-size: 18px;
        }

        .message-time {
            position: absolute;
            bottom: -20px;
            font-size: 11px;
            color: var(--text-secondary);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .message.user .message-time {
            right: 60px;
        }

        .message.bot .message-time {
            left: 60px;
        }

        .message:hover .message-time {
            opacity: 1;
        }

        .chat-input-container {
            padding: 30px;
            background: white;
            border-top: 1px solid var(--border-color);
            position: relative;
        }

        .chat-input-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
        }

        .chat-input-form {
            display: flex;
            gap: 16px;
            align-items: flex-end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        .chat-input {
            width: 100%;
            padding: 18px 24px;
            padding-right: 120px;
            border: 2px solid var(--border-color);
            border-radius: 28px;
            font-size: 16px;
            font-family: inherit;
            outline: none;
            transition: all 0.3s ease;
            background: #f8fafc;
            resize: none;
            max-height: 120px;
            min-height: 56px;
            line-height: 1.5;
        }

        .chat-input:focus {
            border-color: #6a11cb;
            background: white;
            box-shadow: 0 0 0 4px rgba(106, 17, 203, 0.1);
            transform: translateY(-1px);
        }

        .input-actions {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 8px;
        }

        .emoji-button {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 18px;
        }

        .emoji-button:hover {
            background: var(--border-color);
            transform: scale(1.1);
        }

        .send-button {
            width: 56px;
            height: 56px;
            background: var(--chat-gradient);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .send-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .send-button:hover::before {
            left: 100%;
        }

        .send-button:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        .send-button:active {
            transform: translateY(0) scale(0.98);
        }

        .send-button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: var(--shadow-sm);
        }

        .send-button i {
            transition: transform 0.2s ease;
        }

        .send-button:hover:not(:disabled) i {
            transform: translateX(2px);
        }

        .chat-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .status-indicator {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator i {
            font-size: 12px;
            color: #4ade80;
        }

        .reset-button {
            padding: 12px 20px;
            background: var(--danger-gradient);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
        }

        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .reset-button:active {
            transform: translateY(0);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 8px;
            margin: 16px 0;
            color: var(--text-secondary);
            font-size: 14px;
            font-style: italic;
        }

        .typing-indicator.show {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--chat-gradient);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        .welcome-message {
            text-align: center;
            padding: 60px 40px;
            color: var(--text-secondary);
            background: white;
            border-radius: 20px;
            margin: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .welcome-message h2 {
            color: var(--text-primary);
            margin-bottom: 16px;
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .welcome-message p {
            font-size: 16px;
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto;
        }

        .welcome-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .feature-card:hover {
            transform: translateY(-2px);
        }

        .feature-card i {
            font-size: 24px;
            color: #6a11cb;
            margin-bottom: 8px;
        }

        .feature-card h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .feature-card p {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .error-message {
            background: var(--danger-gradient);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            margin: 20px;
            text-align: center;
            font-weight: 500;
            box-shadow: var(--shadow-md);
        }

        /* Enhanced scrollbar styling */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #cbd5e0 0%, #a0aec0 100%);
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #a0aec0 0%, #718096 100%);
        }

        /* Enhanced responsive design */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            .chat-container {
                height: 90vh;
                border-radius: 20px;
                max-width: 100%;
            }

            .chat-header {
                padding: 24px 20px;
            }

            .chat-header h1 {
                font-size: 22px;
            }

            .chat-header p {
                font-size: 14px;
            }

            .online-status {
                top: 15px;
                right: 20px;
                font-size: 12px;
            }

            .chat-messages {
                padding: 20px 16px;
            }

            .message-content {
                max-width: 85%;
                padding: 16px 20px;
                font-size: 14px;
            }

            .message-avatar {
                width: 40px;
                height: 40px;
                font-size: 14px;
                margin: 0 8px;
            }

            .chat-input-container {
                padding: 20px 16px;
            }

            .chat-input {
                font-size: 16px;
                padding: 16px 20px;
                padding-right: 100px;
            }

            .send-button {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }

            .welcome-message {
                padding: 40px 20px;
                margin: 15px;
            }

            .welcome-message h2 {
                font-size: 20px;
            }

            .welcome-features {
                grid-template-columns: 1fr;
                gap: 15px;
                margin-top: 25px;
            }

            .feature-card {
                padding: 16px;
            }
        }

        @media (max-width: 480px) {
            .chat-header h1 {
                font-size: 20px;
                flex-direction: column;
                gap: 8px;
            }

            .chat-input {
                padding-right: 80px;
            }

            .send-button {
                width: 46px;
                height: 46px;
            }

            .message-content {
                max-width: 90%;
                padding: 14px 18px;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --card-bg: #1e293b;
                --text-primary: #f1f5f9;
                --text-secondary: #94a3b8;
                --border-color: #334155;
            }

            .chat-messages {
                background: linear-gradient(to bottom, #1e293b 0%, #0f172a 100%);
            }

            .chat-input {
                background: #334155;
                color: var(--text-primary);
                border-color: var(--border-color);
            }

            .chat-input:focus {
                background: #475569;
            }

            .message.bot .message-content {
                background: #334155;
                color: var(--text-primary);
                border-color: var(--border-color);
            }

            .welcome-message {
                background: #334155;
                color: var(--text-primary);
                border-color: var(--border-color);
            }

            .feature-card {
                background: linear-gradient(135deg, #334155 0%, #475569 100%);
            }
        }

        /* Loading animation */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid #6a11cb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <div class="online-status">
                <div class="online-dot"></div>
                <span>Online</span>
            </div>
            <div class="chat-header-content">
                <h1>
                    <i class="fas fa-graduation-cap"></i>
                    EADE Business School Virtual Receptionist
                </h1>
                <p>Your intelligent AI assistant for admissions, programs, and campus information</p>
            </div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="welcome-message">
                <h2>
                    <i class="fas fa-robot"></i>
                    Welcome to EADE Business School!
                </h2>
                <p>Hello! I'm your virtual receptionist for EADE Business School. I'm here to help you with information about our programs, admissions process, campus locations, and answer any questions you might have. Feel free to start with a simple "hello" or ask me anything about our school!</p>
                
                <div class="welcome-features">
                    <div class="feature-card">
                        <i class="fas fa-book-open"></i>
                        <h4>Programs</h4>
                        <p>Learn about our courses</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-user-graduate"></i>
                        <h4>Admissions</h4>
                        <p>Application process</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-map-marker-alt"></i>
                        <h4>Campus</h4>
                        <p>Locations & facilities</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="chat-input-container">
            <form class="chat-input-form" id="chatForm">
                <div class="input-wrapper">
                    <textarea 
                        class="chat-input" 
                        id="messageInput" 
                        placeholder="Ask me anything about EADE Business School..."
                        rows="1"
                        required
                    ></textarea>
                    <div class="input-actions">
                        <button type="button" class="emoji-button" title="Add emoji">
                            <i class="far fa-smile"></i>
                        </button>
                    </div>
                </div>
                <button type="submit" class="send-button" id="sendButton" title="Send message">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
            <div class="chat-controls">
                <div class="status-indicator" id="statusIndicator">
                    <i class="fas fa-circle"></i>
                    Ready to chat
                </div>
                <button type="button" class="reset-button" id="resetButton">
                    <i class="fas fa-redo-alt"></i>
                    New Conversation
                </button>
            </div>
        </div>
        
        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-spinner"></div>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const chatForm = document.getElementById('chatForm');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const resetButton = document.getElementById('resetButton');
        const statusIndicator = document.getElementById('statusIndicator');
        const loadingOverlay = document.getElementById('loadingOverlay');

        // Auto-focus on input
        messageInput.focus();

        // Auto-resize textarea
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Handle reset button with enhanced UX
        resetButton.addEventListener('click', async () => {
            const confirmDialog = confirm('ðŸ”„ Start a new conversation?\n\nThis will clear all previous messages and reset the chat history.');
            
            if (confirmDialog) {
                try {
                    showLoading();
                    statusIndicator.innerHTML = '<i class="fas fa-sync fa-spin"></i> Resetting conversation...';
                    
                    // Clear chat messages (keep welcome message)
                    const welcomeMessage = document.querySelector('.welcome-message');
                    chatMessages.innerHTML = '';
                    if (welcomeMessage) {
                        chatMessages.appendChild(welcomeMessage);
                    }
                    
                    // Reset conversation on backend
                    await fetch('/reset_conversation', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });
                    
                    statusIndicator.innerHTML = '<i class="fas fa-check"></i> Conversation reset successfully';
                    messageInput.focus();
                    
                    setTimeout(() => {
                        statusIndicator.innerHTML = '<i class="fas fa-circle"></i> Ready to chat';
                    }, 2000);
                    
                } catch (error) {
                    console.error('Error resetting conversation:', error);
                    statusIndicator.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error resetting - Please refresh page';
                } finally {
                    hideLoading();
                }
            }
        });

        // Enhanced form submission with better UX
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const message = messageInput.value.trim();
            if (!message) return;

            // Update status
            statusIndicator.innerHTML = '<i class="fas fa-cog fa-spin"></i> Processing your message...';

            // Add user message to chat
            addMessage(message, 'user');
            
            // Clear input and disable send button
            messageInput.value = '';
            messageInput.style.height = 'auto';
            sendButton.disabled = true;
            sendButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            // Show typing indicator
            showTypingIndicator();

            try {
                // Send message to backend
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });

                const data = await response.json();
                
                // Hide typing indicator
                hideTypingIndicator();

                if (data.status === 'success') {
                    // Add bot response to chat
                    addMessage(data.response, 'bot');
                    statusIndicator.innerHTML = '<i class="fas fa-circle"></i> Ready to chat';
                } else {
                    // Show error message
                    addMessage('I apologize, but I encountered an error while processing your request. Please try again or contact EADE Business School directly for assistance.', 'bot');
                    statusIndicator.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error occurred - Ready to retry';
                    console.error('Chat error:', data.error);
                }
            } catch (error) {
                hideTypingIndicator();
                addMessage('I\'m having trouble connecting right now. Please check your internet connection and try again, or contact EADE Business School directly for immediate assistance.', 'bot');
                statusIndicator.innerHTML = '<i class="fas fa-wifi"></i> Connection error - Ready to retry';
                console.error('Network error:', error);
            } finally {
                // Re-enable send button
                sendButton.disabled = false;
                sendButton.innerHTML = '<i class="fas fa-paper-plane"></i>';
                messageInput.focus();
            }
        });

        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            if (sender === 'user') {
                avatar.innerHTML = '<i class="fas fa-user"></i>';
            } else {
                avatar.innerHTML = '<i class="fas fa-robot"></i>';
            }
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = text;
            
            const time = document.createElement('div');
            time.className = 'message-time';
            time.textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            messageDiv.appendChild(time);
            
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom with smooth animation
            requestAnimationFrame(() => {
                chatMessages.scrollTo({
                    top: chatMessages.scrollHeight,
                    behavior: 'smooth'
                });
            });
        }

        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot';
            typingDiv.id = 'typingIndicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.innerHTML = '<i class="fas fa-robot"></i>';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            
            const indicator = document.createElement('div');
            indicator.className = 'typing-indicator show';
            indicator.innerHTML = '<span>AI is typing</span><div class="typing-dots"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>';
            
            content.appendChild(indicator);
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(content);
            
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTo({
                top: chatMessages.scrollHeight,
                behavior: 'smooth'
            });
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.style.opacity = '0';
                typingIndicator.style.transform = 'translateY(-10px)';
                setTimeout(() => {
                    typingIndicator.remove();
                }, 200);
            }
        }

        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }

        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }

        // Enhanced keyboard shortcuts
        messageInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                chatForm.dispatchEvent(new Event('submit'));
            }
        });

        // Auto-resize chat container on window resize with debouncing
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                chatMessages.scrollTo({
                    top: chatMessages.scrollHeight,
                    behavior: 'smooth'
                });
            }, 150);
        });

        // Add some interactive feedback
        sendButton.addEventListener('mousedown', () => {
            sendButton.style.transform = 'scale(0.95)';
        });

        sendButton.addEventListener('mouseup', () => {
            sendButton.style.transform = '';
        });

        // Enhanced focus management
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.chat-input-container')) {
                // Optional: Auto-focus on input when clicking outside
                // messageInput.focus();
            }
        });

        // Add some easter eggs for better UX
        const welcomeMessages = [
            "Hello! How can I help you with EADE Business School today? ðŸ˜Š",
            "Hi there! What would you like to know about our programs? ðŸŽ“",
            "Welcome! I'm here to answer any questions about admissions. ðŸ“š",
            "Greetings! Feel free to ask about our campus and facilities. ðŸ«"
        ];

        // Simulate a more natural conversation start
        setTimeout(() => {
            if (chatMessages.children.length === 1) { // Only welcome message
                const randomWelcome = welcomeMessages[Math.floor(Math.random() * welcomeMessages.length)];
                // Optional: Add a proactive message after delay
                // addMessage(randomWelcome, 'bot');
            }
        }, 3000);

        // Add visual feedback for successful operations
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--success-gradient);
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: var(--shadow-lg);
                z-index: 1001;
                animation: slideInRight 0.3s ease-out;
            `;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.style.animation = 'slideOutRight 0.3s ease-in forwards';
                setTimeout(() => successDiv.remove(), 300);
            }, 2000);
        }

        // Add CSS animations for success messages
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
